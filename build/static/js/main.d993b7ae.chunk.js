(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{133:function(e,a,t){e.exports=t(166)},166:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(18),o=t.n(l);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(138);var c=t(55),i=t(56),s=t(94),m=t(82),u=t(95),d=t(41),p=t(20),f=t(12),h=t(14),v=t(174),E=t(175),b=t(122),g=t(123),y=t(13),w=t.n(y),N=t(168),O=t(169),k=new(function(){function e(){var a=this;Object(c.a)(this,e),this.loadingDiv=document.createElement("div"),this.createLoading=function(){a.loadingDiv=document.createElement("div");var e=r.a.createElement(N.a,{animation:"border",role:"status",style:{position:"fixed",left:"47%",top:"20%"}},r.a.createElement("span",{className:"sr-only"},"Loading..."));o.a.render(e,a.loadingDiv),document.body.appendChild(a.loadingDiv)},this.killLoading=function(){0!==a.loadingDiv.childNodes.length&&a.loadingDiv.removeChild(a.loadingDiv.childNodes[0])}}return Object(i.a)(e,[{key:"alert",value:function(e,a){console.log("msg");var t=document.createElement("div"),n=r.a.createElement(O.a,{variant:e,style:{position:"fixed",top:0,width:"100%"}},r.a.createElement(O.a.Heading,null,a));o.a.render(n,t),document.body.appendChild(t),setTimeout((function(){document.body.removeChild(t)}),3e3)}}]),e}()),j={userName:"",isAuth:!1};var C=function(e){return console.log("info",e),{type:"AUTH_SUCCESS",info:e}},L=t(28),S=function(e){var a=Object(h.d)((function(e){return e.user.isAuth})),t=Object(h.c)(),l=Object(n.useState)({userName:"",password:""}),o=Object(f.a)(l,2),c=o[0],i=o[1],s=function(e){var a=e.target,t="checkbox"===a.type?a.checked:a.value,n=a.name;i(Object(p.a)({},c,Object(d.a)({},n,t)))};return r.a.createElement("div",null,a?r.a.createElement(L.a,{to:{pathname:"/search"}}):null,r.a.createElement(v.a.Dialog,null,r.a.createElement(v.a.Header,null,r.a.createElement(v.a.Title,null,"Login")),r.a.createElement(v.a.Body,null,r.a.createElement(E.a,null,r.a.createElement(E.a.Group,{as:b.a},r.a.createElement(E.a.Label,null,"Username"),r.a.createElement(E.a.Control,{type:"text",name:"userName",value:c.username,onChange:s}))," ",r.a.createElement(E.a.Group,{as:b.a},r.a.createElement(E.a.Label,null,"Password"),r.a.createElement(E.a.Control,{type:"password",name:"password",value:c.password,onChange:s}))," ")),r.a.createElement(v.a.Footer,null,r.a.createElement(g.a,{variant:"outline-primary",onClick:function(e){t(function(e){if(e)return console.log(e),function(a){return k.createLoading(),w.a.post("/api/user/login",e).then((function(e){console.log(e.data),a(C(e.data)),k.killLoading()})).catch((function(e){k.alert("danger",e.response.data),console.log(e.response.data),k.killLoading()}))};console.log("login input not exist")}(c))}},"Submit"))))},x=t(17),D=t(40),P=function(e){var a=Object(h.c)(),t=Object(n.useState)({userName:"",firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),l=Object(f.a)(t,2),o=l[0],c=l[1],i=function(e){var a=e.target,t="checkbox"===a.type?a.checked:a.value,n=a.name;c(Object(p.a)({},o,Object(d.a)({},n,t)))},s=function(e){e.preventDefault(),a(function(e){if(e)return function(a){return k.createLoading(),w.a.post("api/user/register",e).then((function(e){a(C(e.data)),k.killLoading()})).catch((function(e){console.log("Registration err:",e),k.alert("danger",e.response.data),k.killLoading()}))};console.log("register input not exist")}(o))};return r.a.createElement(x.d,{initialValues:{userName:"",firstName:"",lastName:"",email:"",password:"",confirmPassword:""},validationSchema:D.a().shape({userName:D.c().required("Username is required"),firstName:D.c().required("First Name is required"),lastName:D.c().required("Last Name is required"),email:D.c().email("Email is invalid").required("Email is required"),password:D.c().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:D.c().oneOf([D.b("password"),null],"Passwords must match").required("Confirm Password is required")})},(function(e){var a=e.errors,t=(e.status,e.touched);return r.a.createElement(x.c,{onSubmit:s,onChange:i},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"userName"},"Username"),r.a.createElement(x.b,{name:"userName",type:"text",className:"form-control"+(a.userName&&t.userName?" is-invalid":"")}),r.a.createElement(x.a,{name:"userName",component:"div",className:"invalid-feedback"})),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col-5"},r.a.createElement("label",{htmlFor:"firstName"},"First Name"),r.a.createElement(x.b,{name:"firstName",type:"text",className:"form-control"+(a.firstName&&t.firstName?" is-invalid":"")}),r.a.createElement(x.a,{name:"firstName",component:"div",className:"invalid-feedback"})),r.a.createElement("div",{className:"form-group col-5"},r.a.createElement("label",{htmlFor:"lastName"},"Last Name"),r.a.createElement(x.b,{name:"lastName",type:"text",className:"form-control"+(a.lastName&&t.lastName?" is-invalid":"")}),r.a.createElement(x.a,{name:"lastName",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement(x.b,{name:"email",type:"text",className:"form-control"+(a.email&&t.email?" is-invalid":"")}),r.a.createElement(x.a,{name:"email",component:"div",className:"invalid-feedback"})),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(x.b,{name:"password",type:"password",className:"form-control"+(a.password&&t.password?" is-invalid":"")}),r.a.createElement(x.a,{name:"password",component:"div",className:"invalid-feedback"})),r.a.createElement("div",{className:"form-group col"},r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement(x.b,{name:"confirmPassword",type:"password",className:"form-control"+(a.confirmPassword&&t.confirmPassword?" is-invalid":"")}),r.a.createElement(x.a,{name:"confirmPassword",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mr-2"},"Register"),r.a.createElement("button",{type:"reset",className:"btn btn-secondary"},"Reset")))}))},F=t(106),A=t.n(F),U=t(127),M=function(e){var a=Object(n.useState)(""),t=Object(f.a)(a,2),l=t[0],o=t[1],c=Object(n.useState)("Choose File"),i=Object(f.a)(c,2),s=(i[0],i[1]),m=Object(n.useState)(""),u=Object(f.a)(m,2),h=u[0],b=u[1],y=Object(n.useState)({name:"",keywords:""}),N=Object(f.a)(y,2),O=N[0],k=N[1],j=function(e){var a=e.target,t="checked"===a.name?a.checked:a.value,n=a.name;k(Object(p.a)({},O,Object(d.a)({},n,t))),console.log(O)},C=function(){var a=Object(U.a)(A.a.mark((function a(t){var n;return A.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.preventDefault(),(n=new FormData).append("file",l),n.append("name",O.name),n.append("keywords",O.keywords),a.prev=5,a.next=8,w.a.post("/api/devices/addDevice",n,{headers:{"Content-Type":"multipart/form-data"}});case 8:a.sent,window.location.reload(),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(5),console.log(a.t0);case 15:e.handleClose();case 16:case"end":return a.stop()}}),a,null,[[5,12]])})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{show:e.show,onHide:e.handleClose},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"New Device Form")),r.a.createElement(v.a.Body,null,r.a.createElement(E.a,{onSubmit:C},r.a.createElement("div",{className:"custom-file mb-4"},r.a.createElement(E.a.Control,{type:"file",className:"custom-file-input",id:"customFile",onChange:function(e){var a=e.target.files[0];o(a),s(a.name);var t=window.URL.createObjectURL(a);b(t)}}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"},"file Upload"),r.a.createElement("br",null),r.a.createElement(E.a.Label,null,"Name:"),r.a.createElement(E.a.Control,{type:"text",name:"name",value:O.name,onChange:j}),r.a.createElement(E.a.Label,null,"Keywords:"),r.a.createElement(E.a.Control,{type:"text",name:"keywords",value:O.keywords,onChange:j})),r.a.createElement("img",{style:{width:"100%"},alt:"\xa0no image",src:h}),r.a.createElement("br",null),r.a.createElement(E.a.Control,{type:"submit",value:"Upload",className:"btn btn-primary btn-block mt-4"})),h?r.a.createElement("div",{className:"row mt-5"},r.a.createElement("div",{className:"col-md-6 m-auto"},r.a.createElement("h3",{className:"text-center"},h.fileName))):null),r.a.createElement(v.a.Footer,null,r.a.createElement(g.a,{variant:"secondary",onClick:e.handleClose},"Close"))))};var T=t(170),H=t(171),q=t(172),I=t(176),K=t(132),B=t(100),R=function(e){var a=Object(n.useState)([""]),t=Object(f.a)(a,2),l=t[0],o=t[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{show:e.show,onHide:e.handleClose},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"Add Keywords")),r.a.createElement(v.a.Body,null,l.map((function(e,a){return r.a.createElement("div",{key:a},r.a.createElement(E.a.Control,{placeholder:"Please Input a Keyword",value:e,onChange:function(e){var t=l.map((function(t,n){return n===a?e.target.value:t}));o(t)}}),r.a.createElement("br",null))}))),r.a.createElement(v.a.Footer,null,r.a.createElement(g.a,{onClick:function(){o([].concat(Object(K.a)(l),[""]))},variant:"warning"},"Enter Another Keyword"),r.a.createElement(g.a,{variant:"secondary",onClick:function(){o([""]),e.handleClose()}},"Close"),r.a.createElement(g.a,{variant:"primary",onClick:function(){w.a.post("api/devices/addKey",{addKey:l,device:e.device.name}).then((function(a){e.addKeywords(),o([""]),e.handleClose(),window.location.reload()})).catch((function(e){console.log("err:",e)}))}},"Save Changes"))))},_=t(101),G=function(e){var a=Object(h.d)((function(e){return e.user})),t=a.isAuth,l=a.role,o=Object(n.useState)(""),c=Object(f.a)(o,2),i=c[0],s=c[1],m=Object(n.useState)({InfoModal:!1,addModal:!1,NewDevModal:!1}),u=Object(f.a)(m,2),d=u[0],v=u[1],y=Object(n.useState)({keywords:[]}),N=Object(f.a)(y,2),O=N[0],j=N[1],C=Object(n.useState)([]),S=Object(f.a)(C,2),x=S[0],D=S[1];Object(n.useEffect)((function(){P()}),[]);var P=function(){k.createLoading(),w.a.get("/api/devices/getDevices").then((function(e){var a=e.data.map((function(e){var a="data:image/jpeg;base64,"+function(e){var a="";return[].slice.call(new Uint8Array(e)).forEach((function(e){return a+=String.fromCharCode(e)})),window.btoa(a)}(e.buffer.data);return e.filePath=a,{_id:e._id,name:e.name,keywords:e.keywords,filePath:a}}));console.log(a),D(a),k.killLoading()})).catch((function(e){console.log(e),k.killLoading()}))},F=x.filter((function(e){var a=!1;return e.keywords.forEach((function(e){e.toLowerCase().includes(i.toLocaleLowerCase())&&(a=!0)})),a}));return r.a.createElement("div",null,t?null:r.a.createElement(L.a,{to:"/login"}),"admin"==l?r.a.createElement(g.a,{variant:"success",onClick:function(){v(Object(p.a)({},d,{NewDevModal:!0})),console.log(d)}},"Add New Device"):null,r.a.createElement("h2",{style:{textAlign:"center"}},"Search for devices"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(E.a.Row,{style:{width:"50%"}},r.a.createElement(E.a.Group,{as:b.a},r.a.createElement(T.a,null,r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,null,r.a.createElement(B.a,{icon:_.a}))),r.a.createElement(E.a.Control,{value:i,onChange:function(e){s(e.target.value)},type:"text",placeholder:"Search here.."}))))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(H.a,null,r.a.createElement(q.a,null,F.map((function(e,t){return r.a.createElement(I.a,{style:{width:"80%"},key:t,className:"text-center"},r.a.createElement(I.a.Img,{variant:"top",src:e.filePath}),r.a.createElement(I.a.Body,null,r.a.createElement(I.a.Title,null,e.name),r.a.createElement("strong",null,"keywords:"),r.a.createElement(I.a.Text,null,e.keywords.join(" / "))),r.a.createElement(I.a.Footer,null,r.a.createElement(g.a,{variant:"outline-primary",onClick:function(){!function(e,a){var t=new Date,n=t.getHours>=12?"PM":"AM",r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();t=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+" "+t.getHours()+":"+r+" "+n,w.a.post("/api/checkout/checkout",{userName:a.userName,device:e,checkoutTime:t,checkinTime:"etes"}).then((function(t){k.alert("success",a.userName+", you have checked out: "+e+"."),console.log(t.data)})).catch((function(e){console.log(e.response.message)}))}(e.name,a)}},"Checkout"),"admin"==l?r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{variant:"outline-dark",onClick:function(){j(e),v(Object(p.a)({},d,{addModal:!0})),console.log(d)}},"AddKey"),r.a.createElement(g.a,{variant:"outline-danger",onClick:function(){var a;j(e),a=e._id,console.log(a),w.a.post("/api/devices/deleteDevice",{deviceId:a}).then((function(e){console.log(e.data),window.location.reload()})).catch((function(e){console.log(e.response.message)}))}},"Delete")):null))})))),"admin"==l?r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{show:d.addModal,device:O,addKeywords:function(){},handleClose:function(){v(Object(p.a)({},d,{addModal:!1}))}}),r.a.createElement(M,{show:d.NewDevModal,handleClose:function(){v(Object(p.a)({},d,{NewDevModal:!1}))}})):null)},J=function(e){var a=Object(n.useState)([]),t=Object(f.a)(a,2),l=t[0],o=t[1],c=Object(h.d)((function(e){return e.user}));Object(n.useEffect)((function(){w.a.post("/api/checkout/getUserCheckout",{userName:c.userName}).then((function(e){o(e.data)})).catch((function(e){}))}),[]);var i=l.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null," ",r.a.createElement("b",null,e.userName," ")),r.a.createElement("td",null," ",r.a.createElement("i",null,e.device)," "),r.a.createElement("td",null," ",e.checkoutTime," "))}));return r.a.createElement("div",null,r.a.createElement("h1",null,"Checkout history for ",c.userName),r.a.createElement("table",null,i))},W=function(e){return r.a.createElement("div",null,"password Change")},V=t(34),Y=t(173),$=t(99),z=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(s.a)(this,Object(m.a)(a).call(this,e))).logOut=function(){console.log(t.props.dispatch({type:"LOG_OUT"}))},t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this,a=this.props.navList.filter((function(e){return!1===e.hide}));return r.a.createElement("div",null,r.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(V.b,{class:"navbar-brand",to:"/"},a[0].name),r.a.createElement("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{class:"navbar-toggler-icon"})),r.a.createElement("div",{class:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{class:"navbar-nav mr-auto"},a.filter((function(e){return"main"===e.type})).map((function(e){return r.a.createElement("li",{key:e.name,class:"nav-item"},r.a.createElement(V.b,{class:"nav-link",to:e.path},e.name))}))),r.a.createElement("ul",{class:"navbar-nav ml-auto"},a.filter((function(e){return"user"===e.type})).map((function(a){return"UserCenter"!==a.name?r.a.createElement("li",{key:a.name,class:"nav-item"},r.a.createElement(V.b,{class:"nav-link",to:a.path},a.name)):(console.log(a),r.a.createElement("div",{key:a.name},r.a.createElement(Y.a,{alignRight:!0,title:e.props.user.userName,id:"dropdown-menu-align-right"},a.subItem.map((function(a,t){return"logOut"!==a.name?r.a.createElement($.a.Item,{eventKey:t,key:t,as:V.b,to:a.path},a.name):r.a.createElement("div",{key:t},r.a.createElement($.a.Divider,null),r.a.createElement($.a.Item,{eventKey:t,onClick:e.logOut},"Log Out"))})))))}))))))}}]),a}(n.Component),Q=Object(h.b)((function(e){return e}))(z),X=function(){return r.a.createElement("div",null,"HomePage")},Z=function(e){return Object(n.useEffect)((function(){}),[e.isAuth]),console.log(1),e.isAuth?r.a.createElement(L.a,{to:"/search"}):r.a.createElement(L.a,{to:"/login"})},ee=function(e){function a(e){var t;return Object(c.a)(this,a),t=Object(s.a)(this,Object(m.a)(a).call(this,e)),w.a.get("api/user/info").then((function(e){t.props.history.push("/search"),t.props.dispatch(C(e.data))})).catch((function(e){if(!1===t.props.isAuth){-1===["/login","/register"].indexOf(t.props.history.location.pathname)&&t.props.history.push("/login")}})),t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.isAuth;console.log("user",this.props);var a=[{name:"Home",type:"home",path:"/",component:X,hide:!1},{name:"Search",path:"/search",type:"main",component:G,hide:!e},{name:"Login",type:"user",path:"/login",component:S,hide:e},{name:"Register",type:"user",path:"/register",component:P,hide:e},{name:"UserCenter",type:"user",hide:!e,subItem:[{name:"logOut"},{name:"profile",path:"/profile",component:J},{name:"changePassword",path:"/changePassword",component:W}]}];return r.a.createElement("div",null,r.a.createElement(Q,{navList:a}),r.a.createElement(L.d,null,function(e,a){var t=[];return e.forEach((function(e){!0!==e.hide&&("UserCenter"===e.name?e.subItem.forEach((function(e){"logOut"!==e.name&&t.push(r.a.createElement(L.b,{path:e.path,key:e.name,component:e.component}))})):"Home"===e.name?t.push(r.a.createElement(L.b,{path:e.path,exact:!0,key:e.name,component:e.component})):t.push(r.a.createElement(L.b,{path:e.path,key:e.name,component:e.component})))})),t.push(r.a.createElement(L.b,{path:"*",component:function(){return r.a.createElement(Z,{isAuth:a})},key:"NoMatch"})),t}(a,e)))}}]),a}(n.Component),ae=Object(L.g)(Object(h.b)((function(e){return e.user}))(ee)),te=t(47),ne=t(131),re={};var le=Object(te.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"AUTH_SUCCESS":return Object(p.a)({},e,{userName:a.userName,isAuth:!0},a.info);case"LOG_OUT":return Object(p.a)({},j);default:return e}},device:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,a=arguments.length>1?arguments[1]:void 0;return a.type,e}}),oe=Object(te.e)(le,Object(te.d)(Object(te.a)(ne.a)));o.a.render(r.a.createElement(h.a,{store:oe},r.a.createElement(V.a,null,r.a.createElement(ae,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[133,1,2]]]);
//# sourceMappingURL=main.d993b7ae.chunk.js.map